%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                    .NET                                       %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\n{1}{Platforma .NET}

Platforma .NET od společnosti Microsoft představuje komplexní sadu nástrojů k vývoji aplikací v podporovaných jazycích. Je multiplatformní a umožňuje vývoj pro operační systémy (dále OS) jako Windows, Linux, macOS, ale i pro mobilní platformy a zařízení Internet of Things (dále IoT). Vývojáři mohou využívat nástroje pro vývoj webových aplikací, desktopových aplikací, mobilních aplikací a dalších. Platforma .NET je postavena na dvou hlavních nástrojích. Prvním z nich je \textit{CLR}, běhové prostředí zodpovídající za běh aplikací. Druhým nástrojem je \textit{.NET CLI} (Command Line Interface, dále CLI), konzolový nástroj, zodpovědný za interakci s dílčími nástroji platformy .NET.

\n{2}{Historie}

Využití runtime prostředí, respektive v originální podobě virtuálního stroje, má historický původ. V dřívějších dobách byli programátoři limitování nutností kompilace kódu do nativní reprezentace přímo pro architekturu systému. Kód vytvořen pro jednu konkrétní architekturu se zpravidla neobešel bez modifikací, pokud měl fungovat i na odlišné architektuře.

V průběhu 90. let 20. století představila společnost Sun-Microsystems virtuální stroj Java Virtual Machine (dále JVM). Jedná se o komponentu runtime prostředí Javy, která zprostředkovává spuštění specifického kódu, správu paměti, vytváření tříd, typů a další. Kompilací Javy do tzv. bytecode (Intermediate Language, dále IL), tedy provedením mezikroku v procesu transformace zdrojového kódu do strojového kódu, je získána reprezentace programu, jenž běží na každém zařízení s implementovaným JVM. V rámci JVM dochází k finálním krokům mezi které patří interpretace (JIT kompilace) bytecode do nativního kódu pro cílovou architekturu systému. 

Microsoft v reakci na JVM vydal v roce 2000 první .NET Framework, který umožňoval spouštět kód v jazyce C\# na operačním systému Windows. Cílem prvních verzí .NET Framework nebylo primárně umožnit vývoj pro různé zařízení a operační systémy, ale zprostředkovat lepší nástroje pro vývoj aplikací. \cite{Troelsen2003} V roce 2014 byla vydána první multiplatformní verze platformy .NET. Ta nese název .NET Core a umožňovala spouštět kód v jazyce C\# na operačních systémech Windows, Linux a macOS. 

\n{2}{Architektura}

\obr{.NET platforma}{fig:dotnetplatform}{0.45}{graphics/images/dotnet-platform.drawio.png}

Platforma .NET je postavena na několika klíčových komponentách, které zajišťují běh aplikací a poskytují nástroje pro vývoj aplikací. Mezi nejdůležitější komponenty patří:

\begin{itemize}
    \item \textbf{Common Language Runtime} - CLR je základním kamenem .NET a poskytuje běhové prostředí pro spouštění aplikací na platformě. Překládá IL do nativního kódu, spravuje alokaci paměti a garbage collection (dále GC), zajišťuje zpracování výjimek (exceptions). CLR také kontroluje datové typy, interoperabilitu a zprostředkovává služby nezbytné pro spouštění nejrůznějších aplikací .NET. \cite{Richter2012}
    \item \textbf{.NET CLI} - Všestranný nástroj pro vývoj, kompilaci a nasazení aplikací .NET prostřednictvím rozhraní příkazové řádky. Podporuje širokou škálu operací, od vytváření projektů a správy závislostí až po testování a publikování aplikací. \cite{netdocscli} Prostředí .NET CLI je multiplatformní a dodává sjednocené rozhraní uživatelských nástrojů pro vývoj aplikací .NET. 
    \item \textbf{Microsoft Build} - Microsoft Build (dále MSBuild) je engine používaný v platformě .NET, který umožňuje sestavovat aplikace a vytvářet balíčky pro nasazení. \cite{netdocsmsbuild} Tento nástroj používá k organizaci a řízení procesu sestavení projektový soubor \emph{csproj} na bázi Extensible Markup Language (dále XML). Pomocí něj je zajištěna kontrola nad kompilací a průběhem sestavení. V rámci procesu sestavení lze doplnit vlastní úlohy a cíle kompilace, což poskytuje flexibilitu sestavení pro komplexní procesy ve velkých projektech.
    \item \textbf{Nástroje .NET Software Development Kit} (dále SDK) - Soubor nástrojů a knihoven podporujících vývoj, debugování a testování aplikací .NET. Zahrnují různé CLI a GUI nástroje, které pomáhají vývojářům spravovat práci s kódem, optimalizovat výkon a zajistit kvalitní výstup programu v platformě .NET. \cite{Price2023c8}
    \item \textbf{Roslyn} - Roslyn je sada kompilátorů platformy .NET, která poskytuje bohaté Application Programming Interface (dále API) pro analýzu kódu. \cite{Harrison2017} Umožňuje vývojářům používat implementace kompilátorů jazyka C\# a VB.NET jako služby. Roslyn zlepšuje výkonnost vývojářů poskytnutím funkcí jako je refaktoring, generování kódu a sémantická analýza.
    \item \textbf{NuGet} - Správce balíčků pro platformu .NET. dodává standardizovanou metodu správy externích knihoven, na nichž závisí aplikace v .NET. \cite{Williams2023} Zjednodušuje proces inkorporace knihoven, systémových i třetích stran, do projektu. Rovněž spravuje závislosti, čímž zajišťuje, že projekty zůstávají aktuální a kompatibilní. Tento nástroj je téměř nezbytný pro vývoj na platformě .NET, neboť umožňuje modulární vývoj softwaru (dále SW). 
\end{itemize}

\n{2}{Frameworky}

Platforma .NET poskytuje mnoho frameworků a technologií pro vývoj aplikací. Jednotlivé frameworky plní různé role a poskytují různé úrovně funkcionality pro vývoj aplikací. \cite{Price2023c8} Následující seznam obsahuje některé z nejpoužívanějších frameworků v rámci platformy .NET:

\begin{itemize}
    \item \textbf{.NET} - Hlavní framework platformy .NET pro vývoj SW. Podporuje tvorbu a provoz moderních aplikací a služeb. \cite{Price2023c8} Původně známý jako .NET Framework a primárně zaměřen na prostředí Windows, s příchodem .NET Core a novějších verzí se vyvinul v modulární platformu s open-source zdrojovým kódem známou jednoduše jako .NET. Umožňuje vývojářům vytvářet aplikace, které jsou škálovatelné, výkonné a multiplatformní.
    \item \textbf{ASP.NET} - Robustní framework pro vytváření webových aplikací a služeb. Je součástí ekosystému .NET a navržený tak, aby umožňoval vývoj vysoce výkonných, dynamických webových stránek, API a webových aplikací v reálném čase. \cite{Danylko2023} ASP.NET podporuje jak webové formuláře, tak architekturu Model-View-Controller (dále MVC). S uvedením ASP.NET Core byl framework přepracován pro cloudové nasazení, škálevatolnost, vývoj napříč platformami a vysoký výkon. Poskytuje komplexní základ pro vývoj moderních webových aplikací, které lze spustit jak na Linuxu, Windows tak macOS. ASP.NET Core také představuje Blazor, který umožňuje vývojářům používat C\# při vývoji webu, což dále zvyšuje všestrannost platfomy. \cite{aspnetdocs} Vývojářům, kteří chtějí využít .NET pro vývoj webu, poskytuje ASP.NET komplexní a flexibilní sadu nástrojů pro vytváření všech řešení, od malých webů až po složité webové aplikace. 
    \item \textbf{MAUI} - Moderní specializovaný framework pro vývoj aplikací napříč platformami v rámci ekosystému .NET. Umožňuje vývojářům vytvářet aplikace pro Android, iOS, macOS a Windows z jedné kódové báze. Zakládá na populárních konceptech z Xamarin.Forms a zároveň rozšiřuje jeho možnosti na desktopové aplikace. .NET MAUI zjednodušuje vývojový proces tím, že poskytuje jednotnou sadu nástrojů pro vývoj uživatelského rozhraní na všech platformách s možností přístupu k funkcím specifickým pro platformu v případě potřeby. \cite{Libery2023} Podporuje moderní vývojové vzory a nástroje, včetně Model-View-ViewModel (dále MVVM), datové vazby a asynchronní programování, což usnadňuje vytváření rozsáhlých aplikací. Předchůdcem MAUI je framework Xamarin, který sloužil pro vytváření mobilních aplikací na platformě .NET. 
    \item \textbf{Blazor} - Specializovaný framework v rámci platformy .NET, jenž zprostředkovává vývojářům tvorbu interaktivních webových aplikací pomocí C\# namísto JavaScript. Blazor může běžet na serveru (varianta Blazor Server), kde zpracovává požadavky a komunikuje s uživatelským rozhraním pomocí knihovny SignalR, která zabezpečuje websocket komunikaci. Nebo také jako WebAssembly (dále WASM) aplikace (varianta Blazor WASM), kdy dochází k přeložení C\# kódu do nativního kódu WASM a je spouštěn přímo ve webovém prohlížeči vedle tradičních webových technologií, jako jsou Hypertext Markup Language (dále HTML) a Cascading Style Sheets (dále CSS). \cite{Price2023c8} Umožňuje vývojářům využít znalosti .NET pro tvorbu sofistikovaných webových aplikací, běžících na straně klienta v prohlížeči. Architektura Blazor je založená na komponentách a propaguje opětovné využití kódu pro tvorbu uživatelského rozhraní. Zároveň Blazor podporuje modulární vývojový přístup a poskytuje široké možnosti vývoje webových aplikací v ekosystému .NET.
\end{itemize}

\n{2}{Nástroje}

Platforma .NET zprostředkovává rozsáhlou sadu nástrojů za účelem tvorby, sestavení a spuštění aplikace. V této kapitole budou uvedeny příklady těch nejvýznamnějších.

\n{3}{Knihovny}

Knihovny představují soubor funkcí a tříd, které mohou být použity při vývoji ve více aplikacích. Typicky tvoří obecnou a logicky oddělenou část funkcionality aplikace. Umožňují distribuovat běžnou funkcionalitu napříč různými projekty. \cite{Price2023c8}  Knihovny v .NET mohou být tvořeny binárnimi Dynamic Link Library (dále DLL) soubory nebo referencované jako samostatný projekt pomocí cesty adresáři. K distribuci knihoven obecně dochází pomocí balíčků NuGet. Využitím NuGet jsou knihovny zabaleny a sdíleny přes internetová úložiště. Běžnou praxí tvůrce platformy, programovacího jazyka nebo frameworku je poskytnutí sad knihoven, které usnadňují vývoj aplikací. Zároveň tyto knihovny zpravidla implementují nejběžnější funkcionality, které mohou programátoři vyžadovat. Typicky se jedná o přístup k souborovému systému, síti, databázím, grafickému rozhraní a další. Následující seznam obsahuje některé z nejběžněji používaných knihoven v .NET:

\begin{itemize}
    \item \textbf{System} - Poskytuje základní třídy, typy a rozhraní, které umožňují a podporují širokou škálu operací na úrovni systému, jako jsou vstupy a výstupy (Input/Output, dále IO), využití vláken, kolekcí a další. Je nezbytná prakticky pro každou aplikaci .NET.
    \item \textbf{System.IO} - Dodáva funkcionalitu čtení z datových proudů, souborů a zápis do nich. Zprostředkovává rozhraní pro práci se souborovým systémem.
    \item \textbf{System.Net} - Obsahuje třídy a abstrakce pro síťovou komunikaci a elektronickou poštu.
    \item \textbf{System.Data} - Zajišťuje přístup k datovým zdrojům, jako jsou databáze nebo XML soubory. Obsahuje knihovnu ADO.NET pro přístup k vybraným databázovým implementacím.
    \item \textbf{System.Collections} - Knihovnu tvoří rozhraní a třídy, které definují různé kolekce objektů, jako jsou seznamy, fronty, bitová pole, hašovací tabulky a slovníky.
    \item \textbf{System.Linq} - Zaštiťuje dotazování nad kolekcemi objektů pomocí Language Integrated Query (dále LINQ).
    \item \textbf{System.Threading} - Umožňuje správu vláken, synchronizační primitiva nebo například thread pool. Podporuje vývoj paralelizovaných aplikacích.
    \item \textbf{System.Security} - Spravuje ověřování, autorizaci a šifrování, a je základem pro vývoj bezpečných aplikací.
    \item \textbf{Entity Framework} - Object-Relational Mapping (dále ORM) framework, který umožňuje vývojářům pracovat s databázemi pomocí objektově orientovaného přístupu. Poskytuje abstrakci nad databázovými systémy a umožňuje vývojářům pracovat s daty pomocí objektů aplikace.
\end{itemize}

Kromě knihoven poskytovaných společností Microsoft existuje mnoho knihoven třetích stran. Za vývojem těchto knihoven mohou stát vývojařské komunity nebo být vydány velkými společnostmi. Běžně tyto knihovny navazují na sadu funkcí poskytovaných Microsoftem a rozšiřují je o další novou funkcionalitu, nebo portují známé existující projekty do platformy .NET. Mezi příklady nejznámějších knihoven třetích stran v .NET patří Dapper, AutoMapper, Newtonsoft.Json a další.

\n{3}{Integrované vývojové prostředí}

Neméně důležitým prvkem vývoje aplikací je integrované vývojové prostředí (Integrated Development Environment, dále IDE). I když není povinné, pro spoustu vývojářů je jeho použití při tvorbě aplikací neodmyslitelné. IDE je nástroj, který zprostředkovává vývoj aplikací, správu projektů, debugování a další. IDE poskytuje uživatelské rozhraní, které umožňuje vývojářům vytvářet, upravovat a testovat kód. Dodává vizuální nástroje pro sestavení, testování a publikaci aplikace. Umožňuje provádět různorodé operace v kódu, jako je refaktorování, hledání chyb a ladění. Jedním z nejpoužívanějších IDE je Visual Studio, vyvíjené společností Microsoft. Visual Studio poskytuje prvotřídní podporu pro vývoj na platformě .NET. Mezi další populární IDE patří Visual Studio Code a JetBrains Rider.

\n{3}{Balíčky}

Pro jednoduchou distribuci knihoven, jak systémových tak třetích stran, je využíván nástroj pro správu balíčků NuGet. Projekt, jenž má být distribuován je buďto opatřen atributem \emph{<PackageOnBuild>} a sestaven nebo je využito příkazu \emph{dotnet pack}. Takto vytvořené balíčky lze distribuovat např. přes NuGet.org, což je veřejný repozitář knihoven, který je dostupný pro všechny vývojáře. Možná je také implementace vlastního řešení pro sdílení balíčků. Distribuované knihovny jsou jednoduše importovatelné do projektu a umožňují snadnou správu závislostí.

\n{3}{Dokumentace}

Dokumentace je důležitou součástí vývoje aplikací. Poskytuje informace o tom, jak používat nástroje a technologie, které jsou součástí platformy .NET. Obsahuje informace o API, knihovnách, nástrojích a dalších součástech platformy .NET. Oficiální dokumentace je dostupná online na oficiálních webových stránkách platformy .NET. Obsahuje podrobné informace o mnoha aspektech vývoje aplikací, jako je popis frameworků, tříd, rozhrání, ale i články a návody pro vývojáře. K nalezení je na webu \url{https://docs.microsoft.com/en-us/dotnet/}.

\n{3}{Jazyky}

Aplikace je reprezentována zdrojovým kódem, který má v případě platformy .NET podobu jednoho z (nebo i kombinaci) podporovaných jazyků. Zdaleka nejčastěji využívaným je C\#. Představuje všestranný, objektově orientovaný jazyk navržený tak, aby umožnil vývojářům jednoduše a srozumitelně vyvíjet širokou škálu aplikací. \cite{Price2023c8} Jedná se o staticky typovaný jazyk s širokou škálou moderních funkcí a každoročně podléhá vydání nové verze. Funkčně zaměřené programování je umožňěno pomocí jazyka F\#. Ten je primárně vhodný pro vědecké a datově náročné aplikace. \cite{Price2023c8} Zakládá na silném typování, umožňuje stručný, robustní a výkonný kód. Dalším podporovaným jazykem je VB.NET. Jedná se o moderní verzi jazyka VB, která je implementována na platformě .NET. VB je historický programovací jazyk vyvinutý společností Microsoft. Představený v roce 1991 a navržen s cílem uživatelské přívětivosti. Byl založen na jazyce BASIC a jeho drag-and-drop rozhraní umožňovalo snadné vytváření GUI. Díky tomu zpřístupnil programování širšímu okruhu lidí. V rámci VB byl kladen důraz na rychlý vývoj aplikací (RAD).

\n{2}{Aplikační struktura}

Základním stavebním prvkem aplikace v .NET je projektový soubor. Jedná se o soubor na bázi XML disponující příponou \emph{.csproj}. V rámci něj dochází ke konfiguraci a deklaraci, jak bude .NET CLI, respektive nástroje sestavení, s projektem pracovat. Zároveň jsou zde definované závislosti na další projekty a knihovny. \cite{Alls2023} Mezi základní charakteristiky běžně určené v projektovém souboru patří verze .NET, verze projektu/assembly, seznam závislostí, konfigurace pro buildování, testování a publikaci. Pro tvorbu složitějších aplikací je možné využít více projektových souborů. Tyto souboury jsou seskupeny pomocí speciálního solution souboru. Jedná se o soubor sloužící ke kontejnerizaci a provázání veškerých projektových a pomocných souborů, jako jsou konfigurace setavení, pomocné skripty a další. Disponuje příponou \emph{.sln}. Mezi další běžně používané konfigurační soubory patří následující:

\begin{itemize}
    \item \textbf{appsettings.json} - obsahuje nastavení aplikace
    \item \textbf{launchsettings.json} - deklaruje konfiguraci pro spuštění aplikace
    \item \textbf{Directory.Build.props} - zprostředkovává globální nastavení atributů pro všechny projekty v solution
    \item \textbf{Directory.Build.targets} - obsahuje globální nastavení cílů kompilace pro všechny projekty v solution
    \item \textbf{NuGet.config} - nastavení pro balíčkovací správce NuGet
\end{itemize}

Dalším příkladem projektového souboru je \emph{.fsproj} pro F\# projekty, \emph{.vbproj} pro VB projekty a \emph{.nuspec} pro balíčkovací soubory NuGet. Speciálně pro IDE Visual Studio je využíván soubor \emph{.dcsproj}, který obsahuje nastavení pro spustění a debugování aplikace spuštěné v Docker kontejneru. 

\n{2}{Kompilace zdrojového kódu}

Kompilace je proces transformace zdrojového kódu do jiné podoby. Kód je zpravidla kompilován do podoby bližší cílové architektuře, ať je touto architekturou OS, případně konkrétní hardware (dále HW), nebo runtime prostředí (virtuální stroj). \cite{Richter2012} V rámci .NET jsou k dispozici dva hlavní režimy kompilace zdrojového kódu pro PC platformy: kompilace pro běhové prostředí (CLR) a kompilace do nativního kódu přímo pro cílovou architekturu (native AOT).

Cílem kompilace je převést zdrojový kód do podoby, kterou je možné spustit na cílovém zařízení. Platforma .NET podporuje zacílit na různá zařízení. Typickým cílem kompilace jsou platformy PC. Proces probíhá následujícím způsobem. V případě aplikace běžící v CLR, je kód kompilován do jazyka IL a poté spouštěn prostřednictvím běhového prostředí, přičemž je za běhu převeden na nativní kód. \cite{Richter2012} Pro situace, kdy CLR není k dispozici nebo nemůže být využito, lze použít kompilace AOT pro vygenerování nativního kódu. \cite{Pflug2023} Pro zacílení na mobilní platformy je využito frameworku .NET MAUI ke kompilaci nativní aplikace pro speciální běhové prostředí v Android nebo iOS. \cite{Libery2023}

\n{3}{Obecné postupy kompilace}

Proces kompilace zahrnuje několik charakteristických kroků. V první řadě dochází k parsování zdrojového kódu. Při tomto kroku je analyzována syntaxe kódu a je vytvořena reprezentace programu pomocí Abstract Syntax Tree (dále AST). Následuje krok sémantické analýzy programu. V tento moment je analyzována logika a význam kódu. Dochází ke kontrole typů, vyhodnocení symbolů a další kontrole pravidel jazyka C\#. Kompilace pokračuje krokem přeložení programu do IL. Kód IL je sada instrukcí nezávislá na procesoru, která je spustitelná v běhové prostředí CLR. \cite{Richter2012} V neposlední řadě je IL spolu s metadaty o programu sestaven a zabalen do jednotky nasazení, tzv. \emph{assembly}.  Metadata mají význam v identifikaci, verzování a zabezpečení programu. V rámci kompilace je možno spustit dodatečné procesy. Jedním z volitelných procesů kompilace je linkování. Při něm je využit nástroj IL Linker jenž po procesu sestavení aplikace propojí více assembly tak aby vytvořily jeden spustitelný soubor nebo assembly. \cite{Bock2016} To zahrnuje řešení odkazů mezi různými dll a integraci všech požadovaných zdrojů. Moderních verze .NET umožňují pro kompilaci nastavit proces odebrání nepoužívaného kódu. Tento proces se nazývá \emph{trimming} neboli ořezávání a snižuje velikost aplikace tím, že vylučuje nepotřebné knihovny a větve kódu. \cite{Price2023c8} Je součástí rozsáhlé strategie \emph{Tree shaking}, která optimalizuje výstupní aplikaci.

\n{3}{Kompilace pro CLR}

CLR je zodpovědný za interpretaci IL kódu a jeho dodatečnou kompilaci do nativního kódu. Kompilace do nativního kódu je prováděna JIT za běhu aplikace, což zajišťuje, že kód je optimalizován pro konkrétní architekturu systému. V případě jazyka C\# na platformě Windows slouží ke kompilaci spustitelný soubor \emph{csc.exe}. Assembly typicky disponují příponou \emph{.dll}, případně jsou zabaleny do spustilného souboru dle cílové platformy a výstupu. Takovýto výstup je následně připraven buďto ke spuštění za pomocí CLR nebo pro referenci a využití při tvorbě jiného .NET programu. \cite{Richter2012} Speciálním případem kompilace pro CLR jsou aplikace R2R. Zdrojový kód je při sestavení zkompilován do podoby nativního kódu pomocí nástroje crossgen, čímž vzniknou sestavy Ready To Run (dále R2R). Za běhu se sestavy R2R načtou a spustí s minimální kompilací JIT, protože většina kódu je již v nativní podobě. CLR může přesto JIT kompilovat některé části kódu, které nelze staticky zkompilovat předem. \cite{netdocsr2r} Využití je v aplikacích, které potřebují zkrátit dobu spouštění, ale zachovat určitou funkcionalitu nebo úroveň optimalizace poskytovanou JIT kompilací.

Mezi hlavní výhody kompilace pro CLR, respektive JIT kompilace se řadí zprostředkování následujícího:

\begin{itemize}
    \item  \textbf{Reflexe} - CLR umožňuje využívat reflexi. Tato funkcionalita poskytuje možnost získat informace o kódu za běhu aplikace. Za pomocí reflexe lze vytvářet aplikace, které jsou schopny měnit své chování za běhu.
    \item \textbf{Dynamické načítání} - CLR zprostřekovává možnost dynamicky načítat knihovny za běhu aplikace. Kód spuštěné aplikace je tedy možno rozšířit o další assembly. Aplikace tak mají možnost rozšířit své chování i po spuštění.
    \item \textbf{Větší bezpečnost} - Díky CLR je zajištěno, že aplikace nemůže přistupovat k paměti, která jí nebyla přidělena. Zabezpečuje tak, aby případný škodlivý program se nedostal k paměti jiných aplikací.
    \item \textbf{Správa paměti} - CLR zodpovídá za správu paměti pomocí GC. Zajišťuje, že paměť je uvolněna vždy, když ji aplikace již nepotřebuje. Tím je zabráněno tzv. memory leaks, tedy situacím, kdy alokovaná paměť programu není uvolněna.
    \item \textbf{Větší přenositelnost} - CLR umožňuje spuštění aplikace na všech OS, na kterých je dostupné běhové prostředí CLR.
\end{itemize}

Zatímco za nevýhody CLR se dá považovat:

\begin{itemize}
    \item  \textbf{Výkonnost} - I když určité optimalizace jsou prováděny pro konkrétní systém a architekturu, spousta dodatečný operací probíhá JIT za běhu aplikace. Tyto operace přidávají dodatečnou výkonnostní režii. Dalším výkonnostním měřítkem je rychlost startu aplikace, která je pro CLR vyšší než v případě aplikací v nativním kódu.
    \item \textbf{Velikost aplikace} - Přítomnost CLR nehraje zásádní roli v případě monolitických aplikací, ale v případě mikroslužeb je nutné CLR přidat ke každé službě. Tímto se zvyšuje velikost jedné aplikační instance.
\end{itemize}

\n{3}{Kompilace do nativního kódu}

Přímá nativní AOT kompilace je proces, při kterém je kód kompilován do nativního kódu cílové architektury. Děje se tak v procesu sestavení programu ze zdrojového kódu. V případě platformy .NET je tato funkcionalita dostupná při použití jazyka C\# a speciálních projektových atributů. Obecný postup nativní AOT kompilace sestává ze standartní kompilace a vytvoření IL kódu. Následuje přeložení IL a tvorba ILc souborů (c symbolizuje příponu souborů jazyka C). Ty jsou v následné fázi \emph{IlcCompile} kompilovány pomocí překladače jazyka C. Výstupní soubory jsou prolinkovány ve fázi \emph{LinkNative}. Konečným výstupem nativní AOT kompilace je spustitelný soubor. Tento soubor nabývá formátu dle cílové architektury, jenž byla definována v procesu sestavení. Takto vytvořený soubor je možné spustit přímo v OS bez potřeby CLR.

Tato funkcionalita prošla několika iteracemi. První možnosti sestavení aplikace v nativním kódu na .NET platformě byly aplikace Universal Windows Platform. Jednalo se o aplikace využívající specifické rozhraní, nativní pro vybrané produkty Microsoft. S verzí frameworku .NET 7 byly rozšířeny možnosti sestavení aplikace do podoby nativního kódu i pro další architektury a typy aplikací. \cite{Pflug2023} Tato nová funkcionalita získala vyráznější podporu v roce 2023 s vydáním frameworku .NET 8. Filozofie společnosti Microsoft je, že vývojáři by měli mít možnost využít AOT kompilace na platformě .NET, pokud je to pro daný scénář vhodné. Scénáře kladoucí takovéto požadavky se vyskytují především v cloudovém nasazení, respektivně při implementaci cloudové infrastruky s využitím platformy .NET.

Mezi hlavní výhody nativní AOT kompilace patří:

\begin{itemize}
    \item  \textbf{Nezávislost na CLR} - AOT kompilace umožňuje vytvořit aplikaci, která je schopna běžet bez nutnosti běhového prostředí. To znamená, že jediný soubor obsahuje všechny potřebné knihovny a závislosti.
    \item \textbf{Rychlejší start aplikace} - Aplikace zkompilované do nativního kódu cílové architektury se spouští daleko rychleji než aplikace využívající běhové prostředí.
    \item \textbf{Rychlá odpověď aplikace} - Díky tomu, že aplikace musí mít všechny typy a funkcionality vygenerovány ve chvíli kompilace, je rychlost první odpovědi aplikace vyšší než v případě aplikace využívající běhové prostředí a JIT kompilace.
\end{itemize}

Následující jsou slabé stránky aplikací kompilovaných do nativního kódu v .NET:

\begin{itemize}
    \item \textbf{Absence dynamického načítání} - Neumožňuje dynamicky načítat assembly za běhu aplikace.
    \item \textbf{Bez generování kódu za běhu} - Nelze využít knihovnu System.Reflection.Emit pro generování kódu za běhu aplikace pomocí reflexí.
    \item \textbf{Vyžaduje trimming} - Trimming vyžaduje, aby veškeré nepřímo používané části byly explicitně deklarovány, jinak budou vyřazeny z výsledného kódu.
    \item \textbf{Připojení běhových knihoven} - Veškeré potřebné knihovny jsou součástí výsledného aplikačního souboru. To zvyšuje velikost samoteného programu ve srovnání s aplikacemi závislými na runtime protředí.
    \item \textbf{Kompatibilita knihoven s AOT} - Né všechny knihovny aplikují na svá rozhraní atributy signalizující nekompatibilitu s nativní AOT kompilací. To platí obzvlášť pro knihovny třetích stran. Využití těchto knihoven může bez varování selhat při kompilaci nebo za běhu AOT aplikace.
    \item \textbf{Cross platform sestavení} - .NET SDK umožňuje vytvářet nativní aplikace pouze pro OS stejný jako je ten, na kterém sestavení aplikace probíhá.
\end{itemize}

\n{2}{Běh kódu}

Běh kódu na konkrétním zařízení vyžaduje aby nabýval kompatibilní podoby. To znamená, že jeho reprezentaci OS nativně rozumí a je zacílen na správnou architekturu. V případě nativní AOT kompilace v .NET tento kód získáme již při sestavení aplikace. Při využití kompilace do IL je nutné nativní kód získat JIT kompilací v CLR. Výsledná nativní reprezentace se v obou případech spouští zavoláním vstupní metody programu.

CLR poskytuje spravované prostředí pro spouštění aplikací .NET. Podporuje více programovacích jazyků, včetně jazyků C\#, VB.NET a F\#, a umožňuje jejich bezproblémovou spolupráci. Spravuje paměť prostřednictvím automatického GC, který přiděluje a sbírá paměť využitou objekty. \cite{Richter2012} Tím pomáhá předcházet memory leaks a optimalizuje využití prostředků. CLR poskytuje komplexní model zabezpečení, který pomáhá chránit aplikace před neoprávněným přístupem, poškozením dat a dalšími bezpečnostními hrozbami. Vynucuje zásady zabezpečení, jako je zabezpečení přístupu ke kódu (Code Access Security, dále CAS) a využití rolí při spuštění aplikace. \cite{Richter2012} Zajišťuje, aby kód byl spouštěn s příslušnými oprávněními na základě svého původu a úrovně důvěryhodnosti, čímž chrání citlivá data a systémové prostředky. Důležitou funkcí pro stabilitu systému je zpracování výjimek. To v CLR zahrnuje detekci, propagaci a zpracování chyb nebo stavů, které mohou nastat během provádění programu. Mechanismus vyjímek umožňuje elegantně řešit neočekávané situace a zachovat stabilitu aplikace. CLR zprostředkovává dynamické generování typů za běhu, což aplikacím umožňuje za běhu dynamicky vytvářet a manipulovat typy dle potřeby. \cite{Richter2012} Jednou z nejdůležitějších funkcí CLR představuje reflexe. Díky ní je umožněna validace a manipulace typů, attributů a metadat načtených z assembly za běhu. Reflexe dovoluje dotazovat se a upravovat typy a jejich attributy za běhu, dynamicky volat metody a přistupovat k informacím o metadatech. Díky tomu mají aplikace .NET využívající běhové prostředí výrazné možnosti introspekce a přizpůsobení. CLR obsahuje nástroje pro ladění a profilování, které vývojářům pomáhají debugovat a identifikovat problémy s aplikací. Aby mohl být kód z IL reprezentace spuštěn na systému, respektive HW stroje, musí být dodatečně JIT kompilován. Za tímto účelem existuje v CLR několik technik, které mají využití v specifických scénářích.

Oproti CLR, běh nativního kódu je závislý na konkrétní architektuře systému, pro kterou jsou nativní programové soubory vytvořeny. Nepodléhá další úpravě ze strany .NET nástrojů. Spuštění probíhá nativním příkazem v OS, který je schopen interpretovat a spustit daný soubor

\n{2}{Tvorba programu v .NET}

Následující část popisuje obecnou koncepci a strukturu projektu aplikace v .NET. Součástí je postup pro tvorbu a vydání projektu. Blížší pozornost bude věnována tvorbě projektu využívajícího nativní AOT kompilace.

\n{3}{Obecný postup}

Vytvoření aplikace v .NET zahrnuje několik kroků, které jsou obecně platné pro všechny typy aplikací. V první řádě je potřeba připravit vývojové prostředí, nainstalovat sadu nástrojů .NET SDK a provést počáteční konfiguraci. Následuje vytvoření projektu. Pomocí příkazu \emph{dotnet new} nebo skrze GUI IDE je vytvořen nový projekt a solution soubor. Součástí je výběr typu projektu, jazyka, frameworku a dalších konfiguračních parametrů. Primární fází je samotná tvorba programu, jenž sestává z tvorby kódu, testování a ladění. \cite{Price2023} S procesem programování je spojena správa závislostí. Pomocí nástroje NuGet se referencují balíčky a knihovny, které dodají projektu vyžadovanou funkcionalitu. Následuná kompilace aplikace probíhá pomocí příkazu \emph{dotnet build}, který převede kód v podporovaném jazyce do IL. V případě AOT dochází k dodatečné kompilaci do nativního kódu dle cílové architektury. Finálním krokem je použití příkazu \emph{dotnet publish} a vydání aplikace ve specifické konfiguraci. 

\n{3}{Tvorba nativního programu}

Pro tvorbu nativního programu v .NET je nutné využít speciálního atributu \emph{PublishAoT} v projektovém souboru. Tento atribut je zodpovědný za konfiguraci projektu pro nativní AOT kompilaci. Pokud je v projektu zapnut atribut EmitCompilerGeneratedFiles, kompilátor generuje soubory, které obsahují podrobné informace o stavu zkompilované aplikace. Ty zahrnují i meziprodukty nebo výpisy strojového kódu, které jsou cenné pro procest ladění a analýzy výstupního produktu. \cite{netdocssg} Pomáhají při zacílení na kompilaci do nativního AOT lépe pochopit, jak je vysokoúrovňový kód překládán do strojového kódu. Deklarace unmanaged nebo také nespravovaného rozhraní zahrnuje definování způsobů jakým jednotlivá rozhraní komunikují. Spravované rozhraní představuje zdrojový kód vytvářené aplikace .NET. Nespravované rozhraní jsou funkce operující mimo .NET aplikaci, například v C/C++ knihovně. \cite{Troelsen2003} Pomocí deklarací je specifikován způsob volání. U nativních AOT aplikací je důležité, aby tato rozhraní byla přesně definována a dodržována, protože jakýkoli nesoulad nebo chyba v deklaraci může vést k chybám za běhu, které se hůře diagnostikují a opravují kvůli absenci runtime prostředí a dynamickým funkcím. V rámci nativní AOT kompilace dochází automaticky k ořezávání kódu a jeho linkování do jednoho spustitelného souboru.

\n{3}{Přehled podpory}

Následující přehled představuje rozsah funkcionality implementované v rámci .NET frameworku k datu vydání verze 8.0.4. \cite{aspnetdocs}

\begin{itemize}
    \item \textbf{REST minimal API} - Tvorba minimalistých služeb implementujících REST API.
    \item \textbf{gRPC API} - Komunikace mezi službami pomocí protokolu gRPC.
    \item \textbf{JSON Web Token Authentication} - Autentizace a autorizace za pomocí JSON Web Token (dále JWT) tokenů.
    \item \textbf{CORS} - Konfigurace Cross-Origin Resource Sharing.
    \item \textbf{HealthChecks} - Monitorování stavu aplikace.
    \item \textbf{HttpLogging} - Logování HTTP požadavků.
    \item \textbf{Localization} - Lokalizace aplikace.
    \item \textbf{OutputCaching} - Cachování výstupu.
    \item \textbf{RateLimiting} - Omezení počtu požadavků.
    \item \textbf{RequestDecompression} - Dekomprese požadavků.
    \item \textbf{ResponseCaching} - Cachování odpovědí.
    \item \textbf{ResponseCompression} - Komprese odpovědí.
    \item \textbf{Rewrite} - Přepisování adresy Uniform Resource Locator (dále URL).
    \item \textbf{StaticFiles} - Poskytování statických souborů.
    \item \textbf{WebSockets} - Komunikace pomocí WebSockets.
\end{itemize}
